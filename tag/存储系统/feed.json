{
    "version": "https://jsonfeed.org/version/1",
    "title": "NoResponse's Blog • All posts by \"存储系统\" tag",
    "description": "成分复杂的CSer from ZJU",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2025/07/01/computer-science/computer-organization/ch3/",
            "url": "http://example.com/2025/07/01/computer-science/computer-organization/ch3/",
            "title": "Ch3",
            "date_published": "2025-06-30T16:00:00.000Z",
            "content_html": "<h1 id=\"ch3-存储系统\"><a class=\"markdownIt-Anchor\" href=\"#ch3-存储系统\">#</a> Ch3 存储系统</h1>\n<h2 id=\"存储器概述\"><a class=\"markdownIt-Anchor\" href=\"#存储器概述\">#</a> 存储器概述</h2>\n<h3 id=\"存储器的分类\"><a class=\"markdownIt-Anchor\" href=\"#存储器的分类\">#</a> 存储器的分类</h3>\n<ol>\n<li>按层次分</li>\n</ol>\n<ul>\n<li>主存（小、快、成本高）</li>\n<li>辅存（大、慢、成本低）</li>\n<li>Cache</li>\n</ul>\n<ol start=\"2\">\n<li>按存储介质分</li>\n</ol>\n<ul>\n<li>磁表面存储器（磁盘、磁带）</li>\n<li>磁芯存储器</li>\n<li>半导体存储器（MOS 型、双极型）</li>\n<li>光存储器（光盘）</li>\n</ul>\n<ol start=\"3\">\n<li>按存储方式分</li>\n</ol>\n<ul>\n<li>RAM （随机存储器）: 随机读取存储单元，存取时间与存储单元的物理位置无关。读写方便，主要用作主存和 cache，分静态 RAM 和动态 RAM。</li>\n<li>ROM （只读存储器）：只能读不能写，非易失性，随机读取。广义的 ROM 也可以通过电擦除进行写入 (EEPROM)</li>\n<li>SAM （顺序存储器）：按顺序存储，存取时间与存储单元的物理位置有关</li>\n<li>DAM （直接存储器）：先选取信息所在区域，然后顺序存取。结合了 RAM 和 SAM 的特性（磁盘）</li>\n<li>Associated memory: 不根据地址而是根据存储内容来进行存取的存储器，可以实现快速地查找快表。既可以按照<mark>地址</mark>寻址也可以按照<mark>内容</mark>寻址（通常是某些字段）</li>\n<li>串行访问存储器：SAM 和 DAM 都是，所以读写时间和物理位置有关</li>\n</ul>\n<ol start=\"4\">\n<li>按信息的可保存性分类</li>\n</ol>\n<ul>\n<li>易失性存储器：断电后丢失数据，如 RAM</li>\n<li>非易失性存储器：断电后数据还在，如 ROM，磁盘光盘</li>\n<li>破坏性读出：读出数据后数据被破坏</li>\n<li>非破坏性读出：读出数据后数据不改变</li>\n</ul>\n<h3 id=\"存储器的性能指标\"><a class=\"markdownIt-Anchor\" href=\"#存储器的性能指标\">#</a> 存储器的性能指标</h3>\n<p>三个主要性能指标：存储容量、单位成本、存储速度</p>\n<ol>\n<li>容量 = 存储字数 * 字长</li>\n<li>单位成本 = 总成本 / 总容量</li>\n<li>存储速度：<br>\n存取时间<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>: 启动一次存储器操作到完成该操作所经历的时间，分为读出时间和写入事件<br>\n存取周期<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>: 进行连续读 / 写操作所允许的最短时间间隔<br>\n主存带宽<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">B_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>: b/s, B/s, word/s</li>\n</ol>\n<blockquote>\n<p>存取时间仅为完成一次操作的时间，而存取周期不仅包含操作时间，还包括操作后线路的恢复时间</p>\n</blockquote>\n<h3 id=\"多级层次的存储系统\"><a class=\"markdownIt-Anchor\" href=\"#多级层次的存储系统\">#</a> 多级层次的存储系统</h3>\n<p><img data-src=\"f1.jpg\" alt><br>\n从上到下价格越来越低，速度越来越慢，容量越来越大，CPU 访问频度越来越低<br>\n<img data-src=\"f2.jpg\" alt><br>\n存储时间与存储周期的关系</p>\n<p>主存 - Cache 之间的数据调用由硬件自动完成，对所有程序员均是透明的<br>\n主存 - 辅存的数据调用由硬件和操作系统共同完成，对应用程序员是透明的</p>\n<h2 id=\"主存储器\"><a class=\"markdownIt-Anchor\" href=\"#主存储器\">#</a> 主存储器</h2>\n<p>存储元件：MOS 管</p>\n<h3 id=\"sram-dram\"><a class=\"markdownIt-Anchor\" href=\"#sram-dram\">#</a> SRAM &amp; DRAM</h3>\n<p>RAM: SRAM 静态随机存储器和 DRAM 动态随机存储器<br>\n<mark>主存主要是 DRAM，Cache 主要是 SRAM</mark>，都易失</p>\n<p>DRAM 芯片：使用栅极电容存储信息，只要一个晶体管，读写<mark>更慢</mark>，是<mark>破坏性读出</mark>，需要重写，<mark>成本低，集成度高，功耗低</mark></p>\n<p>SRAM 芯片：使用双稳态触发器存储信息（六晶体管 MOS，RS, JK, D）。读写<mark>更快</mark>，是非破坏性读出，<mark>成本高，集成度低，功耗大</mark><br>\n<img data-src=\"f4.jpg\" alt><br>\n栅极电容需要一直刷新给电容充电，触发器不需要刷新，只要不断电状态不会改变</p>\n<h4 id=\"dram的刷新\"><a class=\"markdownIt-Anchor\" href=\"#dram的刷新\">#</a> DRAM 的刷新</h4>\n<ol>\n<li>多久需要刷新一次？ 刷新周期：一般为 2ms</li>\n<li>每次刷新多少存储单元？以行为单位，每次刷新一行存储单元<br>\n —— 为什么要用行列地址？减少选通线的数量</li>\n<li>在什么时刻刷新？<br>\n有硬件支持，读出一行的信息后重新写入，占用 1 个读 / 写周期<br>\n假设 DRAM 内部结构排列成 128×128 的形式，读 / 写周期 0.5us<br>\n2ms 共 2ms/0.5us = 4000 个周期<br>\n三种刷新方式：<br>\n<img data-src=\"f5.jpg\" alt><br>\n刷新以行为单位，再生（重写）只需要恢复被读出来的存储单元<br>\n刷新由存储器独立完成，不需要 CPU 控制</li>\n</ol>\n<h5 id=\"dram的地址引脚复用技术\"><a class=\"markdownIt-Anchor\" href=\"#dram的地址引脚复用技术\">#</a> DRAM 的地址引脚复用技术</h5>\n<p><img data-src=\"f6.jpg\" alt><br>\n行列地址分成两次送，节省了一半的地址线<br>\n行列数优化原则：尽量使行、列数相同，且行数较少（因为按行刷新）<br>\n目前常用 SDRAM（同步 DRAM），数据交换同步于 CPU 的时钟信号，使得 CPU 不需要等待</p>\n<h3 id=\"rom\"><a class=\"markdownIt-Anchor\" href=\"#rom\">#</a> ROM</h3>\n<p>结构简单、非易失性<br>\n类型：</p>\n<ol>\n<li>MROM 掩模式 ROM<br>\n 在芯片生产过程中写入，无法改变，可靠性高，急程度高，价格便宜，灵活性差</li>\n<li>PROM 一次可编程 ROM<br>\n 可以用专门的设备写入一次，一旦写入无法改变</li>\n<li>EPROM 可擦除可编程 ROM<br>\n 可以写入并多次改写，但是编程次数有限且时间长</li>\n<li>Flash<br>\n 兼有 RAM 和 ROM 的优点，可以不加电长期保存信息，又能在线快速擦除和重写，价格便宜，急程度高，电可擦除重写且速度快<br>\n SSD 固态硬盘基于 Flash，由控制单元和 Flash 组成，长期保存、快速擦除和重写，对比传统硬盘读写速度快。低功耗。但是价格高</li>\n</ol>\n<h3 id=\"主存储器的基本组成\"><a class=\"markdownIt-Anchor\" href=\"#主存储器的基本组成\">#</a> 主存储器的基本组成</h3>\n<p>核心部件：一个个存储 0 或 1 的存储单元构成的存储矩阵<br>\n访问主存时，CPU 把地址送到 MAR，MAR 通过地址总线把地址送到主存中的地址寄存器，地址译码器进行译码，选中相应的内存单元，然后通过控制电路决定读 / 写操作：</p>\n<ul>\n<li>读操作：将选中的内存单元的内容通过数据总线送到 MDR 中</li>\n<li>写操作：将 MDR 中的内容通过数据总线送到选中的内存单元中<br>\n MDR 的位数和数据总线位数相同，通常等于存储字长；MAR 的位数和地址总线位数相同</li>\n</ul>\n<h3 id=\"多模块存储器\"><a class=\"markdownIt-Anchor\" href=\"#多模块存储器\">#</a> 多模块存储器</h3>\n<p>DRAM 芯片的恢复时间比较长，有可能是存取时间的几倍（SRAM 的恢复时间较短）。CPU 的读写速度比主存快很多，主存恢复时间太长<br>\n —— 利用多个完全相同的存储模块并行工作来提高吞吐率：单体多字存储器，多体低位交叉存储器</p>\n<ul>\n<li>双端口 RAM（408 不考，了解即可）<br>\n<img data-src=\"f7.jpg\" alt></li>\n</ul>\n<ol>\n<li>\n<p>单体多字存储器<br>\n一般一个存储单元只存储一个 word，但是单体多字存储器一个存储单元存储多个 word，然后读的时候一次性读取这多个字。好处是快，缺点是只有指令和数据连续存放时才能提高存取速度，否则造成不必要的读取。</p>\n</li>\n<li>\n<p><mark>多体并行存储器（重点）</mark><br>\n分为高位交叉编址和低位交叉编址两种<br>\n<img data-src=\"f8.jpg\" alt><br>\n高位交叉编址每一块存储体的高位是一样的，实际上还是顺序存储。因此访问连续内存实际上访问的还是同一块存储体，并不能通过并行加快访问速度<br>\n低位交叉编址的每一块存储体低位相同，因此可以在恢复时间并行存取下一块内存的数据<br>\n存取周期为 <code>T</code> , 存取时间为 <code>r</code> , T = r + 恢复时间<br>\n对于 n 个存储器并行访问的存储器：<br>\n采用高位交叉编址的时间为 <code>n*T</code> <br>\n 低位交叉编址为 <code>T + (n-1)*r</code></p>\n</li>\n</ol>\n<p><img data-src=\"f9.png\" alt></p>\n<ul>\n<li>轮流启动：每个 bank 的存储位数等于数据总线的位数，此时采用轮流启动\n<ul>\n<li>对于低位交叉编址，要保证 <code>m&gt;=T/r</code> ，以保证流水线不间断</li>\n<li>理想情况下，m 个 bank 的交叉存储器每隔 <code>T/m</code>  个周期可以读 / 写一个数据，若相邻 m 次访问的当存地址出现在同一个模块内，则会发生访存冲突，此时需要延迟发生冲突的访问请求。</li>\n</ul>\n</li>\n<li>同时启动：如果 m 个 bank 的总位数加起来刚好等于数据总线的位数，则 m 个同时存 / 取</li>\n</ul>\n<h2 id=\"主存储器与cpu的连接\"><a class=\"markdownIt-Anchor\" href=\"#主存储器与cpu的连接\">#</a> 主存储器与 CPU 的连接</h2>\n<h3 id=\"连接原理\"><a class=\"markdownIt-Anchor\" href=\"#连接原理\">#</a> 连接原理</h3>\n<p>通过总线连接（控制、地址、数据）<br>\n传输速率 = 总线宽度 / 传输时间<br>\n地址总线的位数决定了可寻址的最大内存空间<br>\n控制总线指出总线周期的类型和本次输入输出完成的时刻<br>\n将多个芯片集成在内存条上，由多个内存条和主板上的 ROM 芯片组成计算机所需的主存空间，通过总线与 CPU 连接</p>\n<h3 id=\"主存容量的扩展\"><a class=\"markdownIt-Anchor\" href=\"#主存容量的扩展\">#</a> 主存容量的扩展</h3>\n<p>数据总线宽度 &gt; 存储字长 —— 位扩展<br>\n地址总线宽度 &gt; 存储字数量所需的宽度<br>\n<img data-src=\"f10.jpg\" alt></p>\n<ol>\n<li>\n<p>位扩展法：增加存储字长<br>\n由于数据总线宽度大于存储字长，存在浪费情况，必须进行位扩展使数据位数与数据总线位数相等<br>\n如图：<br>\n<img data-src=\"f11.jpg\" alt></p>\n</li>\n<li>\n<p>字扩展法<br>\n地址总线存在浪费情况，对存储字的数量进行扩展<br>\n用多出来的地址线提供 CS 片选信号，决定输出的是哪个芯片的数据</p>\n</li>\n</ol>\n<ul>\n<li>线选法：n 条多余的地址线，对应 n 个选片信号，地址空间不连续造成地址空间浪费（只能有一个 1 有效），电路简单<br>\n<img data-src=\"f13.jpg\" alt></li>\n<li>译码器选法：n 条多余的线对应<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.664392em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> 个选片信号，地址空间可以连续<br>\n<img data-src=\"f12.jpg\" alt></li>\n</ul>\n<ol start=\"3\">\n<li>字、位同时扩展<br>\n既增加存储字的数量，又增加存储字长<br>\n<img data-src=\"f14.jpg\" alt></li>\n</ol>\n<h3 id=\"存储芯片的地址分配和片选\"><a class=\"markdownIt-Anchor\" href=\"#存储芯片的地址分配和片选\">#</a> 存储芯片的地址分配和片选</h3>\n<p>见上方线选法译码器选法</p>\n<h3 id=\"存储器与cpu的连接\"><a class=\"markdownIt-Anchor\" href=\"#存储器与cpu的连接\">#</a> 存储器与 CPU 的连接</h3>\n<p>…<br>\n 片选信号还与 CPU 的方寸控制信号<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mrow><mi>M</mi><mi>R</mi><mi>E</mi><mi>Q</mi></mrow><mo stretchy=\"true\">‾</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\overline{MREQ}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0777700000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord overline\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8833300000000001em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\">Q</span></span></span><span style=\"top:-3.80333em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span></span></span></span> 有关（低电平有效），若 CPU 访问 IO 则此信号为高电平</p>\n",
            "tags": [
                "存储系统"
            ]
        }
    ]
}